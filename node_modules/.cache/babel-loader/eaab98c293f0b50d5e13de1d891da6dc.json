{"ast":null,"code":"import _slicedToArray from\"/Users/vyshnavajayan/Desktop/DG-REACT/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{Suspense,useCallback,useRef,useState}from\"react\";import'./Home.css';import{useSelector,useDispatch}from'react-redux';import{useEffect}from'react';import*as homeAction from'../../actions/homeActions';import LoadingIcon from'../../assets/placeholder_for_missing_posters.png';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ImageSearchHeader=/*#__PURE__*/React.lazy(function(){return import('../../shared/components/ImageSearchHeader');});var ImageCard=/*#__PURE__*/React.lazy(function(){return import(\"../../shared/components/ImageCard\");});function Home(){var imageList=useSelector(function(state){return state.home.imageList;});var title=useSelector(function(state){return state.home.title;});var _useState=useState(1),_useState2=_slicedToArray(_useState,2),pageNumber=_useState2[0],setPageNumber=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),searchText=_useState4[0],setSearchText=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),headerEffect=_useState6[0],setHeaderEffect=_useState6[1];var dispatch=useDispatch();var observer=useRef();var first_card_observer=useRef();var lastImageCardRef=useCallback(function(node){if(observer.current)observer.current.disconnect();observer.current=new IntersectionObserver(function(entries){if(entries[0].isIntersecting){if(pageNumber<3){setPageNumber(function(prevPageNumber){return prevPageNumber+1;});}}});if(node)observer.current.observe(node);});var firstImageCardRef=useCallback(function(node){if(first_card_observer.current)first_card_observer.current.disconnect();first_card_observer.current=new IntersectionObserver(function(entries){if(entries[0].isIntersecting){setHeaderEffect(true);}else{setHeaderEffect(false);}});if(node)first_card_observer.current.observe(node);});//To search after finished typing the name.\nuseEffect(function(){if(searchText.length>0){var delayDebounceFn=setTimeout(function(){dispatch(homeAction.imageSearchRequest(searchText));},1000);return function(){return clearTimeout(delayDebounceFn);};}else{dispatch(homeAction.imageListRequest(1,true));}},[dispatch,searchText]);var onSearch=function onSearch(text){setSearchText(text);};// To make the image list request when page number changes.\nuseEffect(function(){dispatch(homeAction.imageListRequest(pageNumber));},[dispatch,pageNumber]);return/*#__PURE__*/_jsxs(\"div\",{className:\" bg-black flex flex-col px-[30px] sm:scrollbar-hide\",children:[/*#__PURE__*/_jsx(Suspense,{fallback:/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"img\",{src:LoadingIcon,className:\"h-6 w-6\",alt:\"Back\"})}),children:/*#__PURE__*/_jsx(ImageSearchHeader,{imageHeaderRef:firstImageCardRef,showHeaderEffect:headerEffect,onSearch:onSearch,title:title})}),/*#__PURE__*/_jsx(\"div\",{className:\" overflow-y-auto sm:scrollbar-hide grid grid-cols-3 gap-[30px] mt-14 \",children:imageList.length>0?imageList.map(function(image,index){return/*#__PURE__*/_jsx(Suspense,{fallback:/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"img\",{src:LoadingIcon,className:\"h-6 w-6\",alt:\"Back\"})}),children:1===index?/*#__PURE__*/_jsx(ImageCard,{imageCardRef:firstImageCardRef,image:image},index):imageList.length===index+1?/*#__PURE__*/_jsx(ImageCard,{imageCardRef:lastImageCardRef,image:image},index):/*#__PURE__*/_jsx(ImageCard,{image:image},index)});}):/*#__PURE__*/_jsx(\"div\",{className:\"h-screen\"})})]});}export default Home;","map":{"version":3,"sources":["/Users/vyshnavajayan/Desktop/DG-REACT/src/modules/Home/index.js"],"names":["React","Suspense","useCallback","useRef","useState","useSelector","useDispatch","useEffect","homeAction","LoadingIcon","ImageSearchHeader","lazy","ImageCard","Home","imageList","state","home","title","pageNumber","setPageNumber","searchText","setSearchText","headerEffect","setHeaderEffect","dispatch","observer","first_card_observer","lastImageCardRef","node","current","disconnect","IntersectionObserver","entries","isIntersecting","prevPageNumber","observe","firstImageCardRef","length","delayDebounceFn","setTimeout","imageSearchRequest","clearTimeout","imageListRequest","onSearch","text","map","image","index"],"mappings":"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","sourcesContent":["\nimport React, { Suspense, useCallback,useRef,useState} from \"react\";\nimport './Home.css';\nimport { useSelector,useDispatch } from 'react-redux';\nimport { useEffect } from 'react';\nimport * as homeAction from '../../actions/homeActions';\nimport LoadingIcon from '../../assets/placeholder_for_missing_posters.png';\n\nconst ImageSearchHeader = React.lazy(() => import('../../shared/components/ImageSearchHeader'));\nconst ImageCard = React.lazy(() => import(\"../../shared/components/ImageCard\"));\n\nfunction Home() {\n    const imageList = useSelector(state => state.home.imageList);\n    const title = useSelector(state => state.home.title);\n\n    const [pageNumber,setPageNumber] = useState(1);\n    const [searchText, setSearchText] = useState('');\n    const [headerEffect,setHeaderEffect] = useState(false);\n\n    const dispatch = useDispatch();\n    const observer = useRef();\n    const first_card_observer = useRef();\n\n    const lastImageCardRef = useCallback(node => {\n      if (observer.current) observer.current.disconnect()\n      observer.current = new IntersectionObserver(entries => {\n       \n        if (entries[0].isIntersecting) {\n          if(pageNumber < 3){\n          setPageNumber(prevPageNumber => prevPageNumber + 1);\n          }\n        }\n      })\n      if (node) observer.current.observe(node)\n    });\n\n    const firstImageCardRef = useCallback(node => {\n      if (first_card_observer.current) first_card_observer.current.disconnect()\n      first_card_observer.current = new IntersectionObserver(entries => {\n        if (entries[0].isIntersecting) {\n          setHeaderEffect(true)\n        }else{\n          setHeaderEffect(false)\n        }\n      })\n      if (node) first_card_observer.current.observe(node)\n    });\n\n    //To search after finished typing the name.\n    useEffect(() => {\n      if (searchText.length > 0) {\n        const delayDebounceFn = setTimeout(() => {\n      \n          dispatch(homeAction.imageSearchRequest(searchText));\n        }, 1000);\n        return () => clearTimeout(delayDebounceFn);\n      } else {\n    \n        dispatch(homeAction.imageListRequest(1,true));\n      }\n    }, [dispatch, searchText]);\n\n    const onSearch = (text) =>{\n      setSearchText(text);\n    }\n\n    // To make the image list request when page number changes.\n    useEffect(()=>{\n        dispatch(homeAction.imageListRequest(pageNumber))\n    },[dispatch,pageNumber]);\n\n\n  return (\n    <div className=\" bg-black flex flex-col px-[30px] sm:scrollbar-hide\">\n      <Suspense\n        fallback={\n          <div>\n            <img src={LoadingIcon} className=\"h-6 w-6\" alt=\"Back\" />\n          </div>\n        }\n      >\n        <ImageSearchHeader\n          imageHeaderRef={firstImageCardRef}\n          showHeaderEffect={headerEffect}\n          onSearch={onSearch}\n          title={title}\n        />\n      </Suspense>\n\n      <div className=\" overflow-y-auto sm:scrollbar-hide grid grid-cols-3 gap-[30px] mt-14 \">\n        {imageList.length > 0 ? (\n          imageList.map((image, index) => {\n            return (\n              <Suspense\n                fallback={\n                  <div>\n                    <img src={LoadingIcon} className=\"h-6 w-6\" alt=\"Back\" />\n                  </div>\n                }\n              >\n                {1 === index ? (\n                  <ImageCard\n                    imageCardRef={firstImageCardRef}\n                    key={index}\n                    image={image}\n                  />\n                ) : imageList.length === index + 1 ? (\n                  <ImageCard\n                    imageCardRef={lastImageCardRef}\n                    key={index}\n                    image={image}\n                  />\n                ) : (\n                  <ImageCard key={index} image={image} />\n                )}\n              </Suspense>\n            );\n          })\n        ) : (\n          <div className=\"h-screen\"></div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default Home;"]},"metadata":{},"sourceType":"module"}